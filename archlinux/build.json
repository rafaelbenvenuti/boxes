{ "description": "ArchLinux Virtual Machine Template."
, "variables": { "cpus": "2"
               , "memory": "2048"
               , "video_memory": "16"
               , "disk_size": "25600"
               , "swap_size": "4096"
               , "headless": "false"
               , "language": "en"
               , "country": "DE"
               , "locale": "en_US.UTF-8"
               , "keymap": "br-abnt2"
               , "hostname": "unassigned-hostname"
               , "domain": "unassigned-domain"
               , "time-zone": "Europe/Berlin"
               , "ntp-server": "0.archlinux.pool.ntp.org"
               }
, "builders": [ { "type": "virtualbox-iso"
                , "guest_os_type": "ArchLinux_64"
                , "export_opts": [ "--manifest"
                                 , "--vsys", "0"
                                 , "--description", "ArchLinux Virtual Machine Template."
                                 , "--version", "{{isotime \"2006.01\"}}.01" ]
                , "iso_url": "http://mirror.rackspace.com/archlinux/iso/{{isotime \"2006.01\"}}.01/archlinux-{{isotime \"2006.01\"}}.01-x86_64.iso"
                , "iso_checksum_url": "http://mirror.rackspace.com/archlinux/iso/{{isotime \"2006.01\"}}.01/sha1sums.txt"
                , "iso_checksum_type": "sha1"
                , "communicator": "ssh"
                , "ssh_username": "vagrant"
                , "ssh_password": "password"
                , "ssh_wait_timeout": "60m"
                , "vm_name": "archlinux"
                , "output_directory": "output-archlinux"
                , "headless": "{{user `headless`}}"
                , "guest_additions_mode": "disable"
                , "disk_size": "{{user `disk_size`}}"
                , "hard_drive_interface": "sata"
                , "hard_drive_nonrotational": true
                , "hard_drive_discard": true
                , "iso_interface": "sata"
                , "virtualbox_version_file": ""
                , "vboxmanage": [ [ "modifyvm", "{{.Name}}", "--description", "ArchLinux Virtual Machine Template."
                                                           , "--chipset", "ich9"
                                                           , "--firmware", "efi"
                                                           , "--audio", "none"
                                                           , "--cpus", "{{user `cpus`}}"
                                                           , "--cpuhotplug", "on"
                                                           , "--memory", "{{user `memory`}}"
                                                           , "--vram", "{{user `video_memory`}}"
                                                           , "--keyboard", "ps2"
                                                           , "--mouse", "ps2"
                                                           , "--rtcuseutc", "on"
                                                           , "--hpet", "on"
                                                           , "--acpi", "on"
                                                           , "--ioapic", "on"
                                                           , "--x2apic", "on"
                                                           , "--biosapic", "x2apic"
                                                           , "--rtcuseutc", "on"
                                                           , "--hwvirtex", "on"
                                                           , "--nestedpaging", "on"
                                                           , "--largepages", "on"
                                                           , "--vtxvpid", "on"
                                                           , "--vtxux", "on"
                                                           , "--pae", "off"
                                                           , "--nictype1", "virtio"
                                                           , "--nic1", "nat"
                                                           , "--audio", "none"
                                                           , "--usb", "off" ] 
                                , [ "storagectl", "{{.Name}}", "--name", "SATA Controller"
                                                             , "--hostiocache", "on" ]
                                , [ "storageattach", "{{.Name}}", "--storagectl", "SATA Controller"
                                        , "--device", "0"
                                        , "--port", "0"
                                        , "--nonrotational", "on"
                                        , "--hotpluggable", "on" ]
                                , [ "storagectl", "{{.Name}}", "--name", "IDE Controller"
                                                             , "--remove" ] ]
                , "vboxmanage_post": [ [ "modifyvm", "{{.Name}}", "--boot1", "disk"
                                                                , "--boot2", "none"
                                                                , "--boot3", "none"
                                                                , "--boot4", "none" ] ]
                , "http_directory": "http"
                , "boot_wait": "45s"
                , "boot_command": [ "curl -O 'http://{{.HTTPIP}}:{{.HTTPPort}}/install-{base,chroot}.sh'<enter><wait>"
                                  , "bash install-base.sh < install-chroot.sh && systemctl reboot<enter>" ]
                , "shutdown_command": "sudo systemctl poweroff" } ]
, "post-processors": [ { "type": "vagrant"
                       , "compression_level": 9
                       , "output": "archlinux.box" }
                     , { "type": "shell-local"
                       , "inline": "vagrant box add --name archlinux archlinux.box" } ]
}
